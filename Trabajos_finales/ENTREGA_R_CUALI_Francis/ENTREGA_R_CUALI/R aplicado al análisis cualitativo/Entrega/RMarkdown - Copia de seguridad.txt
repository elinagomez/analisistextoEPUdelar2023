---
title: 'Trabajo Final: R aplicado al análisis cualitativo'
author: "Francis Silvera"
date: "2022-2023"
output:
  word_document: default
  pdf_document: default
---

```{r setup, include=FALSE, echo=FALSE}

library(readtext)
library(quanteda)
library(magrittr)
library(ggplot2)
library(quanteda.textstats)
library(quanteda.textplots)
library(reshape2)
library(puy)
library(knitr)
library(dplyr)

```

## "Que el letrista no se olvide": Breve análisis de los textos de diez conjuntos de murga participantes del Concurso Oficial de Carnaval 2023 mediante el uso de R para el análisis cualitativo

La murga, además de una manifestación artística de larga data en nuestro país, puede ser concebida como un espacio de reflexión crítica sobre la coyuntura sociopolítica uruguaya. Los textos que estructuran los espectáculos murgueros suelen buscar, según sus propias referencias, la amplificación de las voces populares, exponiendo mediante la sátira, la crítica y la emotividad aquellos temas que se destacaron por su impacto social durante el año. Al decir de Gandolfo (2007), “la murga hace referencia en forma casi permanente a hechos sociales, económicos y políticos del acontecer nacional e integra personajes y espacios físicos que pertenecen al país” (Gandolfo, 2007: 23). En otras palabras, podría decirse que los textos (re)presentados por los distintos conjuntos  configuran una radiografía del Uruguay actual desde el punto de vista de las clases populares. 

Lo dicho en carnaval no solo es relevante en tanto síntesis de lo sucedido en el año anterior a su presentación, sino también por su capacidad de generar opinión pública, politizar cuestiones propias del ámbito privado e instalar una serie de temáticas en la agenda. Además, según afirma Gandolfo (2007), “el carnaval es una de las manifestaciones artísticas más importantes de nuestro país en lo que a captación de público se refiere”, lo cual hace que sea “imperioso indagar sobre una expresión cultural que consigue cautivar a tanta cantidad de personas y a la cual se le reconoce grandes rasgos de originalidad (…). Investigar sobre la murga es una forma de examinar los aspectos que van edificando día a día la identidad colectiva.” (Gandolfo, 2007: 4). 

A raíz de estas afirmaciones cabría preguntarse: ¿qué nos dicen los textos producidos por los conjuntos que concursan este año sobre la coyuntura actual? ¿Cuáles son las temáticas y los hechos sociopolíticos que gravitaron con mayor fuerza? ¿Existen diferentes énfasis entre los textos de los distintos conjuntos o las temáticas abordadas suelen coincidir? Si existiesen diferencias significativas, ¿podrían explicarse por la antigüedad de los conjuntos? ¿Y por la conformación de sus equipos creativos en términos de género?  

En el afán de contestar a estas preguntas, se conformó una muestra con los textos de diez conjuntos de murga. Cinco de ellos son conjuntos “tradicionales” en virtud de su larga trayectoria en el Concurso Oficial de Carnaval (“La Gran Muñeca”, “Nos Obligan a Salir”, “Queso Magro”, “Curtidores de Hongos”, “Diablos Verdes”), mientras que los cinco restantes son conjuntos surgidos en los últimos años –en su mayoría provienen del concurso de Murga Joven–, y por ende cuentan con menos experiencia en el Concurso Oficial (“Barrio Querido”, “Gente Grande”, “Mi Vieja Mula”, “Jardín del Pueblo”, “Un Título Viejo”). Esta decisión metodológica tiene como objetivo el contraste de los textos de los distintos conjuntos en función de su antigüedad. Otra variable de interés tenida en cuenta en la selección de la muestra fue la participación de mujeres en la creación de los textos. Cinco de las murgas seleccionadas (“Gente Grande”, “La Gran Muñeca”, “Queso Magro”, “Un título viejo”, “Diablos Verdes”) cuentan con al menos una mujer letrista, mientras que los equipos creativos de las cinco murgas restantes están compuestos exclusivamente por hombres (“Mi Vieja Mula”, “Barrio Querido”, “Nos Obligan a Salir”, “Curtidores de Hongos”, “Jardín del Pueblo”).

Entre los textos de las diez murgas seleccionadas, se han analizado aquellos fragmentos que cuentan con mayor contenido político: el “popurrí” o “salpicón”, sección del espectáculo donde se comentan los hechos políticos más destacables del año con una cuota de sátira, y los “cuplés”, donde se abordan temas de diversa índole con un tono crítico, emotivo y/o humorístico, dependiendo de cada caso. Fueron excluidos del análisis los textos correspondientes a la presentación y la retirada de las murgas. 

El análisis de los textos se realizó utilizando diversas funcionalidades del software R para el análisis cualitativo de texto, todas las cuales serán comentadas con mayor detalle a lo largo del presente trabajo. 

El proceso de análisis comenzó con la recuperación de los textos de las diez murgas seleccionadas en función de las dos variables comentadas anteriormente (antigüedad y género de los letristas). Algunos de los textos fueron facilitados por los letristas en formato Word (.docx), mientras que otros fueron transcriptos directamente de los videos del Concurso Oficial de Carnaval disponibles en Youtube, también en formato Word (.docx).

Para su recuperación e importación al entorno de RStudio se utilizó el paquete “readtext”. Cada uno de los textos fue importado y almacenado bajo la forma de un objeto perteneciente a la clase “data.frame” que llevó el nombre del conjunto de murga correspondiente. Posteriormente, se anexaron a cada uno de los data.frames dos nuevas columnas: “antigüedad” y “genero_letristas”, a fin de categorizar los textos y permitir el análisis comparativo. Por último, todos estos objetos fueron agrupados en una única base de datos. 

```{r message=FALSE, warning=FALSE, include=FALSE, echo=FALSE}

Un_Titulo_Viejo <- readtext::readtext("C:/Users/Usuario/Desktop/R aplicado al análisis cualitativo/Entrega/Datos/Un_Titulo_Viejo.docx")

Queso_Magro <- readtext::readtext("C:/Users/Usuario/Desktop/R aplicado al análisis cualitativo/Entrega/Datos/Queso_Magro.docx")

Curtidores_De_Hongos <- readtext::readtext("C:/Users/Usuario/Desktop/R aplicado al análisis cualitativo/Entrega/Datos/Curtidores_De_Hongos.docx")

La_Gran_Muñeca <- readtext::readtext("C:/Users/Usuario/Desktop/R aplicado al análisis cualitativo/Entrega/Datos/La_Gran_Muñeca.docx")

Gente_Grande <- readtext::readtext("C:/Users/Usuario/Desktop/R aplicado al análisis cualitativo/Entrega/Datos/Gente_Grande.docx")

Barrio_Querido <- readtext::readtext("C:/Users/Usuario/Desktop/R aplicado al análisis cualitativo/Entrega/Datos/Barrio_Querido.docx")

Jardin_Del_Pueblo <- readtext::readtext("C:/Users/Usuario/Desktop/R aplicado al análisis cualitativo/Entrega/Datos/Jardín_Del_Pueblo.docx")

Mi_Vieja_Mula <- readtext::readtext("C:/Users/Usuario/Desktop/R aplicado al análisis cualitativo/Entrega/Datos/Mi_Vieja_Mula.docx")

Nos_Obligan_A_Salir <- readtext::readtext("C:/Users/Usuario/Desktop/R aplicado al análisis cualitativo/Entrega/Datos/Nos_Obligan_A_Salir.docx")

Diablos_Verdes <- readtext::readtext("C:/Users/Usuario/Desktop/R aplicado al análisis cualitativo/Entrega/Datos/Diablos_Verdes.docx")
  
Barrio_Querido[3] <- "Nueva"
Curtidores_De_Hongos[3] <- "Tradicional"
Gente_Grande[3] <- "Nueva"
Jardin_Del_Pueblo[3] <- "Nueva"
La_Gran_Muñeca[3] <- "Tradicional"
Queso_Magro[3] <- "Tradicional"
Un_Titulo_Viejo[3] <- "Nueva"
Mi_Vieja_Mula[3] <- "Nueva"
Nos_Obligan_A_Salir[3] <- "Tradicional"
Diablos_Verdes[3] <- "Tradicional"

Barrio_Querido[4] <- "No tienen mujeres letristas"
Curtidores_De_Hongos[4] <- "No tienen mujeres letristas"
Gente_Grande[4] <- "Tienen mujeres letristas"
Jardin_Del_Pueblo[4] <- "No tienen mujeres letristas"
La_Gran_Muñeca[4] <- "Tienen mujeres letristas"
Queso_Magro[4] <- "Tienen mujeres letristas"
Un_Titulo_Viejo[4] <- "Tienen mujeres letristas"
Mi_Vieja_Mula[4] <- "No tienen mujeres letristas"
Nos_Obligan_A_Salir[4] <- "No tienen mujeres letristas"
Diablos_Verdes[4] <- "Tienen mujeres letristas"

df_textos <- rbind(Barrio_Querido, Curtidores_De_Hongos, 
                   Gente_Grande, Jardin_Del_Pueblo, La_Gran_Muñeca, 
                   Queso_Magro, Un_Titulo_Viejo, Mi_Vieja_Mula, 
                   Nos_Obligan_A_Salir, Diablos_Verdes)

colnames(df_textos) <- c("doc_id", "texto", "antiguedad", "genero_letristas")

```

El análisis de los textos se desarrolló en varias etapas: en primer lugar, se construyeron nubes de palabras y tablas de frecuencia a partir de los términos más recurrentes; en segundo lugar, se procedió al análisis de asociación entre las palabras más frecuentes y la construcción de redes de co-ocurrencia; en tercer lugar, se realizó un análisis en base a tres diccionarios, dos de ellos construidos para el caso y uno pre-existente (LWIC-Spanish) orientado a identificar las emociones presentes en los textos.

# Términos más frecuentes y nubes de palabras 

La frecuencia con que los textos aluden a determinados términos, si bien no nos informa del sentido que se les atribuyó, constituye un buen indicador de los tópicos que estructuraron los textos de los distintos conjuntos. Las nubes de palabras, así como los gráficos de frecuencia relativa, nos permiten visualizar con mayor facilidad estas tendencias discursivas.

Previo al procesamiento de los datos, se realizó una limpieza de texto que quitó aquellos términos que no aportaban contenido al análisis (adverbios, preposiciones, artículos, nombres propios de los integrantes de cada murga y palabras que no contaban con un contenido específico fuera del contexto del espectáculo, entre otros). Esta limpieza de texto incluyó, además, la conversión de todos los caracteres a “tokens” o unidades de análisis, la eliminación de los signos de puntuación y los números, y la definición de un mínimo de cinco apariciones de cada término para su inclusión en el análisis.

```{r message=FALSE, warning=FALSE, include=FALSE, echo=FALSE}
mis_stopwords <- c("abajo", "acá", "ahí", "allá", "allí", "alrededor", "aquí", 
                  "arriba", "atrás", "cerca", "debajo", "delante", "dentro", "vemos",
                  "detrás", "fuera", "encima", "enfrente", "lejos", "adelante", 
                  "además", "así", "bien", "como", "cuando", "cual", "que", "donde",
                  "ahora", "algún", "año*", "mes", "día", "huevo", "iba", "ves", 
                  "aquel", "aquello*", "bien", "buen*", "cada", "caso", "claro", 
                  "exacto", "obvio", "oh", "uh", "uy", "mm", "murga*", "carnaval",
                  "murguero", "murguista", "fiesta", "música", "popurrí", "salpicón",
                  "ser", "estar", "estoy", "estás", "sos", "vos", "tú", "yo", "palabra",
                  "dale", "bo", "vo", "papá", "pa", "menos", "más", "veces", "vez",
                  "usted", "subir", "bajar", "Maxi", "Martincito", "tema*", "un*", 
                  "dice", "digo", "dijo", "dijimos", "dijiste", "vio", "viste", "vamo",
                  "vieron", "fui", "fueron", "van", "están", "para", "por", "pou",
                  "además", "aparte", "algo", "aproximadamente", "bastante", "casi",
                  "demasiado", "incluso", "más", "menos", "mucho", "muy", "nada", "poco", 
                  "solamente", "solo", "tan", "tanto", "todo", "cien", "uno", "dos",
                  "tres", "cosas", "creemos", "creo", "cuestiones", "dar", "dan",
                  "debe", "demás", "desde", "después", "igual", "distinto", "entonces",
                  "ante", "bajo", "cabe", "con", "contra", "de", "desde", "durante",
                  "en", "este", "esto*", "entre", "hacia", "hasta", "para", "por", 
                  "según", "sin", "con", "sobre", "tras", "estas", "mediante", "hay",
                  "ver", "había", "habla*", "hace*", "haciendo", "vida", "vivi*",
                  "hicieron", "hizo", "hace", "lado", "largo", "corto", "traigo", 
                  "llevo", "bien", "mal", "manera", "forma", "cuestiones", "temas",
                  "voz", "mayor", "menor", "mil*", "nadie", "ningún", "ninguna",
                  "cuplé", "parte", "espectáculo", "otr*", "puede", "puedo", "quier*", 
                  "queremos", "quizás", "porque", "tal vez", "capaz", "realmente",
                  "saber", "sabemos", "sabe", "entend*", "también", "tampoco", "i",
                  "tal", "tiene", "tenemos", "quiere", "quieremos", "pedo", "últimos",
                  "últimas", "vamos", "van", "cuenta", "visto", "voy","alguien", 
                  "semana", "lugar", "siguiente", "anterior", "venir", "mañana",
                  "ayer", "pasa", "paso", "diciendo", "vengan", "[Música]", "reina",
                  "[Risas]", "[Aplausos]", "ay", "el", "la", "si", "no", "ellos",
                  "ellas", "ustedes", "mirá", "querés", "cómo", "cuándo", "dónde",
                  "quiénes", "quién", "dicen", "mejor", "peor", "gusta", "encanta",
                  "vas", "aunque", "siempre", "nunca", "da", "doy", "soy", "sos", 
                  "gran", "mismo", "muchas", "muchos", "poco", "pocos", "sé", "carlos",
                  "sabés", "mirá", "mira", "llegó", "llega", "ir", "volver", "vinagre",
                  "parece", "mientras", "durante", "después", "tablado", "velódromo",
                  "cuatro", "cinco", "decir", "todas", "todos", "llegamos", "llegaron",
                  "hice", "hace", "tenés", "tienen", "tengo", "tenías", "viene*", 
                  "pongo", "ponés", "sale", "salgo", "ejemplo", "pitufo", "va", "hoy",
                  "pasó", "pasa*", "toda", "todo", "pasar", "alguna", "alguno","¡",
                  "decís", "anda", "seis", "momento", "etapa", "instante", "modo",
                  "sigue*", "fin", "eh", "ah", "hola", "chau", "che", "cualquier*",
                  "nombre*", "medio", "juan", "siete", "temprano", "tarde", "favor",
                  "noche", "tarde", "sabes", "vivo", "cosa", "importa", "flor",
                  "treinta", "recién", "vayan", "pued*", "nuevo", "dej*", "sabe*",
                  "sali*", "horas", "minutos", "cuál", "ojos", "hora", "sartori-",
                  "hago", "hacen", "hicieron", "papa", "nombrar", "afuera", "adentro",
                  "salida", "llegada", "cara", "limón", "perro", "gato", "tene*",
                  "podés", "mitocondria", "tipo", "das", "viven", "onda", "pas*",
                  "formas", "meses", "años", "todavía", "carlos-", "papa-", "is", "of", "dij*",
                  "is", "of", "biden-", "misma", "cuent*", "qued*", "ven", "maría",
                  "hacé", "andá", "poné", "precis*", "necesit*", "pone", "podemos",
                  "dio", "toca*", "di", "llega*", "teatro", "muñeca", "fondo", "diablos")

toks <- tokens(df_textos$texto) %>%
        tokens_compound(phrase("lacalle pou"), concatenator = "_")

dfm_textos <- dfm(tokens(toks,
                  remove_punct = TRUE, 
                  remove_numbers = TRUE), 
                  tolower=TRUE,
                  verbose = FALSE) %>%
                  dfm_remove(pattern = c(quanteda::stopwords("spanish"),
                  mis_stopwords)) %>%
                  dfm_trim(min_termfreq = 5) %>%
                  dfm_group(groups = df_textos$antiguedad)
```

Una vez terminado el preprocesamiento de los datos, se construyó una primera nube de palabras que da cuenta de los tópicos más recurrentes a nivel global.


```{r message=FALSE, warning=FALSE, include=TRUE, echo=FALSE}

wordcloud_general <- quanteda.textplots::textplot_wordcloud(dfm_textos, 
                                       min.count = 2,
                                       max_words = 100,
                                       random.order = FALSE,
                                       colors = RColorBrewer::brewer.pal(8,"Dark2"),
                                       comparison = F) 
```

A partir de esta primera nube de palabras puede observarse que los conjuntos aluden con frecuencia a las palabras “gente”, “pueblo”, “vecino” y “barrio”, coincidiendo con lo dicho anteriormente acerca del rol de las murgas como portavoces de las clases populares, con un fuerte arraigo barrial. La palabra “Uruguay”, segunda en frecuencia de aparición,  da cuenta de que los tópicos más mencionados refieren de una forma u otra al país. “Democracia”, “trabajo”, “gobierno”, “presidente”, “escuela”, “reforma” se revelan como los temas de índole política -en el sentido de que refieren a "lo común"- que han atravesado a gran parte de los textos. Otros términos frecuentes, tales como “verdad” o “repetir”, se hacen más difíciles de interpretar fuera de su contexto de aparición, y no pueden ser ligados a cuestiones políticas per se. Para ello se recurrirá más adelante al análisis de asociación de palabras y las redes de co-ocurrencia. Los resultados provistos por la nube de palabras pueden ser visualizados con mayor precisión a través de un gráfico de frecuencias.

```{r message=FALSE, warning=FALSE, echo=FALSE, include=FALSE}
topwords_general = data.frame(topfeatures(dfm_textos, 15))
topwords_general$Palabra = rownames(topwords_general)
colnames(topwords_general)[1] <- "Frecuencia"
rownames(topwords_general) <- NULL
```

```{r message=FALSE, warning=FALSE, include=TRUE, echo=FALSE}

plot_topwords_general <-  ggplot(topwords_general, 
                          aes(x = reorder(Palabra, Frecuencia), 
                              y = Frecuencia,
                              fill = Palabra)) +
                          geom_col(show.legend = FALSE) +
                          coord_flip() +
                          theme_minimal() +
                          ggtitle("Palabras más recurrentes",
                          subtitle="En los textos de las murgas") +
                          ylab("Frecuencia de aparición") +
                          xlab("") +
                          scale_fill_manual(values = c(rep("#D7B5D8", 15)))
plot_topwords_general

```

Para el análisis de los términos más frecuentes en función de los años de trayectoria de cada conjunto, se procedió a la identificación de dos grupos: “murgas tradicionales” y “murgas nuevas”. La nube de palabras y los gráficos de frecuencia que se muestran a continuación surgen del análisis comparativo entre estos dos grupos.  

```{r echo=FALSE, message=FALSE, warning=FALSE, include=TRUE}

dfm_textos <- dfm(tokens(toks,
                  remove_punct = TRUE, 
                  remove_numbers = TRUE), 
                  tolower=TRUE,
                  verbose = FALSE) %>%
                  dfm_remove(pattern = c(quanteda::stopwords("spanish"),
                  mis_stopwords)) %>%
                  dfm_trim(min_termfreq = 5) %>%
                  dfm_group(groups = df_textos$antiguedad)

wordcloud_antiguedad <- quanteda.textplots::textplot_wordcloud(dfm_textos, 
                                       min.count = 2,max_words = 100,
                                       random.order = FALSE,
                                       colors = RColorBrewer::brewer.pal(8,"Dark2"),
                                       comparison = T)

df_antiguedad <- split(df_textos, df_textos$antiguedad)
df_murgas_tradicionales <- df_antiguedad[[2]]
df_murgas_nuevas <- df_antiguedad[[1]]

toks_murgas_tradicionales <- tokens(df_murgas_tradicionales$texto) %>%
                             tokens_compound(phrase("lacalle pou"), concatenator = "_")
                             
dfm_murgas_tradicionales <- dfm(tokens(toks_murgas_tradicionales,
                         remove_punct = TRUE, 
                         remove_numbers = TRUE), 
                         tolower=TRUE,
                         verbose = FALSE) %>%
                         dfm_remove(pattern = c(quanteda::stopwords("spanish"),
                         mis_stopwords)) %>% 
                         dfm_trim(min_termfreq = 5)

topwords_murgas_tradicionales = data.frame(topfeatures(dfm_murgas_tradicionales, 15))
topwords_murgas_tradicionales$Palabra = rownames(topwords_murgas_tradicionales)
colnames(topwords_murgas_tradicionales)[1] <- "Frecuencia"
rownames(topwords_murgas_tradicionales) <- NULL

plot_topwords_murgas_tradicionales <-  ggplot(topwords_murgas_tradicionales, 
                                       aes(x = reorder(Palabra, Frecuencia), 
                                       y = Frecuencia,
                                       fill = Palabra)) +
                                       geom_col(show.legend = FALSE) +
                                       coord_flip() +
                                       theme_minimal() +
                                       ggtitle("Palabras más recurrentes",
                                       subtitle = "En las murgas con mayor trayectoria") + 
                                       ylab("Frecuencia de aparición") +
                                       xlab("") +
                                       scale_fill_manual(values = c(rep("#D7B5D8", 15)))

plot_topwords_murgas_tradicionales 

toks_murgas_nuevas <- tokens(df_murgas_nuevas$texto) %>%
                      tokens_compound(phrase("lacalle pou"), concatenator = "_")

dfm_murgas_nuevas <- dfm(tokens(toks_murgas_nuevas,
                         remove_punct = TRUE, 
                         remove_numbers = TRUE), 
                         tolower=TRUE,
                         verbose = FALSE) %>%
                         dfm_remove(pattern = c(quanteda::stopwords("spanish"),
                         mis_stopwords)) %>% 
                         dfm_trim(min_termfreq = 5)

topwords_murgas_nuevas = data.frame(topfeatures(dfm_murgas_nuevas, 15))
topwords_murgas_nuevas$Palabra = rownames(topwords_murgas_nuevas)
colnames(topwords_murgas_nuevas)[1] <- "Frecuencia"
rownames(topwords_murgas_nuevas) <- NULL

plot_topwords_murgas_nuevas <-  ggplot(topwords_murgas_nuevas, 
                                      aes(x = reorder(Palabra, Frecuencia), 
                                      y = Frecuencia,
                                      fill = Palabra)) +
                                      geom_col(show.legend = FALSE) +
                                      coord_flip() +
                                      theme_minimal() +
                                      ggtitle("Palabras más recurrentes",
                                      subtitle="En los textos de las murgascon menor trayectoria")                                       +
                                      ylab("Frecuencia de aparición") +
                                      xlab("") +
                                      scale_fill_manual(values = c(rep("#D7B5D8", 15)))

plot_topwords_murgas_nuevas
```
Tal como se desprende de los gráficos, los términos “gente” y “Uruguay” se posicionan como los dos más utilizados por ambos grupos, con pequeñas variaciones en cuanto a su ubicación. El término “pueblo”, que ocupa el cuarto lugar en los textos de las murgas con menos años de trayectoria, aparece en el puesto número quince de las murgas tradicionales. “Trabajo”, por su parte, es aludida en mayor medida por las murgas más tradicionales, ocupando el cuarto puesto. Al respecto de esta diferencia, cabe destacar que gran parte de las murgas tradicionales se gestaron en un ámbito sindical, siendo atravesadas desde sus orígenes por el trabajo como centro de conflicto. Esta podría llegar a ser una de las posibles explicaciones a la diferencia recién observada.  La mención al actual presidente del país través de su apellido (“Lacalle”) o su cargo (“presidente”),  se observa únicamente en las murgas nuevas, quedando por fuera de las quince menciones más frecuentes de las murgas tradicionales. La palabra “reforma”, que podría referir tanto a la reforma educativa como de la seguridad social, aparece exclusivamente en las murgas más tradicionales. Las distinciones observadas en cuanto a los temas abordados por cada grupo comienzan a delinear un panorama que será complementado por análisis posteriores.

Veamos ahora el análisis de los términos más frecuentes en función del género de los letristas, para lo cual se conformaron dos grupos: aquellos que cuentan con al menos una mujer letrista en sus equipos creativos (“tienen mujeres letristas”), y aquellos compuestos exclusivamente por varones (“no tienen mujeres letristas”).

```{r echo=FALSE, message=FALSE, warning=FALSE, include=TRUE}

dfm_textos <- dfm(tokens(toks,
                  remove_punct = TRUE, 
                  remove_numbers = TRUE), 
                  tolower=TRUE,
                  verbose = FALSE) %>%
                  dfm_remove(pattern = c(quanteda::stopwords("spanish"),
                  mis_stopwords)) %>%
                  dfm_trim(min_termfreq = 5) %>%
                  dfm_group(groups = df_textos$genero_letristas)

wordcloud_genero <- quanteda.textplots::textplot_wordcloud(dfm_textos, 
                                       min.count = 2,
                                       max_words = 100,
                                       random.order = FALSE,
                                       colors = RColorBrewer::brewer.pal(8,"Dark2"),
                                       comparison = T)

df_genero <- split(df_textos, df_textos$genero_letristas)
df_letristas_mujeres <- df_genero[[2]]
df_letristas_varones <- df_genero[[1]]

toks_letristas_varones <- tokens(df_letristas_varones$texto) %>%
                          tokens_compound(phrase("lacalle pou"), concatenator = "_")

dfm_letristas_varones <- dfm(tokens(toks_letristas_varones,
                                remove_punct = TRUE, 
                                remove_numbers = TRUE), 
                                tolower=TRUE,
                                verbose = FALSE) %>%
                                dfm_remove(pattern = c(quanteda::stopwords("spanish"),
                                mis_stopwords)) %>% 
                                dfm_trim(min_termfreq = 5)

topwords_letristas_varones = data.frame(topfeatures(dfm_letristas_varones, 15))
topwords_letristas_varones$Palabra = rownames(topwords_letristas_varones)
colnames(topwords_letristas_varones)[1] <- "Frecuencia"
rownames(topwords_letristas_varones) <- NULL

plot_topwords_letristas_varones <-  ggplot(topwords_letristas_varones, 
                                      aes(x = reorder(Palabra, Frecuencia), 
                                      y = Frecuencia,
                                      fill = Palabra)) +
                                      geom_col(show.legend = FALSE) +
                                      coord_flip() +
                                      theme_minimal() +
                                      ggtitle("Palabras más recurrentes",
                                      subtitle="En los textos escritos por varones") +
                                      ylab("Frecuencia de aparición") +
                                      xlab("") +
                                      scale_fill_manual(values = c(rep("#D7B5D8", 15)))

plot_topwords_letristas_varones

toks_letristas_mujeres <- tokens(df_letristas_mujeres$texto) %>%
                          tokens_compound(phrase("lacalle pou"), concatenator = "_")

dfm_letristas_mujeres <- dfm(tokens(toks_letristas_mujeres,
                            remove_punct = TRUE, 
                            remove_numbers = TRUE), 
                            tolower=TRUE,
                            verbose = FALSE) %>%
                            dfm_remove(pattern = c(quanteda::stopwords("spanish"),
                            mis_stopwords)) %>% 
                            dfm_trim(min_termfreq = 5)

topwords_letristas_mujeres = data.frame(topfeatures(dfm_letristas_mujeres, 15))
topwords_letristas_mujeres$Palabra = rownames(topwords_letristas_mujeres)
colnames(topwords_letristas_mujeres)[1] <- "Frecuencia"
rownames(topwords_letristas_mujeres) <- NULL

plot_topwords_letristas_mujeres <-  ggplot(topwords_letristas_mujeres, 
                                     aes(x = reorder(Palabra, Frecuencia), 
                                     y = Frecuencia,
                                     fill = Palabra)) +
                                     geom_col(show.legend = FALSE) +
                                     coord_flip() +
                                     theme_minimal() +
                                     ggtitle("Palabras más recurrentes",
                                     subtitle = "En los textos escritos por al menos una mujer") +
                                     ylab("Frecuencia de aparición") +
                                     xlab("") +
                                     scale_fill_manual(values = c(rep("#D7B5D8", 15)))

plot_topwords_letristas_mujeres
```
A partir de la nube de palabras puede observarse una mayor presencia de la familia a través de varias de sus figuras (“mamá”, “madre”, “padre”, “tío”, “abuela”, “hermano”) en las murgas cuyos letristas son varones en su totalidad. Los términos “amor” y “pareja” también tienen una mayor presencia en este grupo, disputando la visión esteoreotípica de que las mujeres son más propensas a colocar estas temáticas en la escena pública que los varones. 
Ahora bien, si prestamos atención a los gráficos de frecuencia, se observa una tendencia más bien uniforme en cuanto a las palabras más utilizadas por uno y otro grupo. Los términos suelen repetirse (“Uruguay”, “gente”, “pueblo”, “democracia”), con pequeñas variaciones en cuanto a su ubicación. 

Si bien cabría esperar que una mayor presencia de mujeres en los equipos creativos desembocase en alusiones más frecuentes a la temática de género en la escena, no parece haber indicios de que esto suceda. Esto no quiere decir que la problemática de género haya quedado excluida de los textos, ni tampoco que la participación de letristas mujeres no sea significativa: al tratarse de una manifestación artística, las temáticas pueden ser abordadas a través del uso de metáforas, eufemismos y otras figuras literarias que se alejan de las palabras que normalmente utilizaríamos para identificar la temática (“mujeres”, “feminismo”, “género”, “violencia de género”, etc.). Además, cabe destacar que si bien las murgas categorizadas bajo el grupo “tienen mujeres letristas” cuentan con al menos una mujer letrista en sus equipos creativos, los mismos siguen siendo predominantemente masculinos. Posteriores análisis se ocuparán de profundizar sobre esta cuestión para corroborar si la distinción por género es pasible de arrojar una diferencia significativa en cuanto a las temáticas propuestas.

## Asociación entre palabras y redes de co-ocurrencia

Como se decía anteriormente, el análisis de los términos utilizados con más frecuencia no alcanza a reflejar “cómo se habla” de cada uno de los temas, sino tan solo “de qué se habla”. Los análisis de asociación entre palabras, al recuperar el contexto de aparición de los términos más frecuentes, nos aproximan en mayor medida al tono con que fueron dichos o el sentido que les fue atribuido. A continuación se presentan los resultados de dos análisis que van en esta línea.

El primero de ellos resulta del cálculo de un coeficiente de correlación entre algunos de los términos más frecuentes a nivel general –es decir, sin diferenciar por antigüedad ni por género de los letristas– y el resto de los términos presentes en cada texto. Los términos seleccionados en este caso fueron “gente”, “gobierno” y “Lacalle”, por su capacidad de ser ilustrativos de la manera en que se habla de parte de la realidad política del país. A continuación se presentan los resultados de este análisis.

```{r echo=FALSE, message=FALSE, warning=FALSE, include=TRUE}
dfm_textos <- dfm(tokens(toks,
                  remove_punct = TRUE, 
                  remove_numbers = TRUE), 
                  tolower=TRUE,
                  verbose = FALSE) %>%
                  dfm_remove(pattern = c(quanteda::stopwords("spanish"),
                  mis_stopwords)) %>%
                  dfm_trim(min_termfreq = 5)

asoc_gente <- textstat_simil(dfm_textos, selection = "gente",
                             method = "correlation",margin = "features")%>%
  as.data.frame()%>%
  dplyr::arrange(-correlation)%>%
  dplyr::top_n(12)

asoc_gente$correlation <- round(asoc_gente$correlation,2)

plot_asoc_gente <- ggplot(asoc_gente, aes(x = reorder(feature1, correlation), 
                                         y = correlation,
                                         fill = feature2)) +
                                         geom_bar(stat = "identity", position = "dodge") +
                                         geom_text(aes(label = correlation), vjust = -0.5, size = 3) +
                                         coord_cartesian(ylim = c(0.50, 1)) +
                                         xlab("") +
                                         ylab("Nivel de Correlación") +
                                         scale_fill_manual(values = c(rep("#D7B5D8", 12))) +
                                         ggtitle("Palabras correlacionadas con el término 'Gente'") +
                                         theme(legend.position="none")

plot_asoc_gente
```
Entre las doce palabras que más correlacionan con el término “gente”, destacan principalmente “matan” por su fuerte connotación negativa,  y “comida” en tanto podría implicar una referencia a la alimentación como una problemática que afecta a “la gente” en su totalidad. Esto es, no obstante, una hipótesis a corroborar, dado que la palabra “comida” no tiene per se una connotación negativa. La alta correlación entre “gente” y “pueblo”, por otra parte, nos permite pensar que se utilizan como sinónimos, mientras que el término “laburar” da cuenta de la asociación conceptual entre la murga con la clase trabajadora. La correlación relativamente alta entre “viejos” y “gente” puede tomarse como un indicio de que la abstracción “gente” se personifica muchas veces en las personas de mayor edad, a quienes las murgas refieren con frecuencia. 

```{r echo=FALSE, message=FALSE, warning=FALSE, include=TRUE}
asoc_gobierno <- textstat_simil(dfm_textos, selection = "gobierno",
               method = "correlation",margin = "features")%>%
               as.data.frame()%>%
               dplyr::arrange(-correlation)%>%
               dplyr::top_n(12)

asoc_gobierno$correlation <- round(asoc_gobierno$correlation,2)

plot_asoc_gobierno <- ggplot(asoc_gobierno, aes(x = reorder(feature1, correlation), 
                      y = correlation,
                      fill = feature1)) +
                      geom_bar(stat = "identity", position = "dodge") +
                      geom_text(aes(label = correlation), vjust = -0.5, size = 3) +
                      coord_cartesian(ylim = c(0.50, 1)) +
                      xlab("") +
                      ylab("Nivel de Correlación") +
                      scale_fill_manual(values = c(rep("#D7B5D8", 12))) +
                      ggtitle("Palabras correlacionadas con la palabra 'Gobierno'") + 
                      theme(legend.position="none")
plot_asoc_gobierno
```

La primera palabra de este segundo gráfico de correlación, “chiste”, es muy elocuente a los efectos de comprender cómo se refieren los distintos conjuntos al gobierno. A su vez, la alta correlación entre “gobierno” y “hambre” parece confirmar la hipótesis que se planteaba anteriormente acerca de la alimentación como una problemática que afecta a la gente, confirmando su connotación negativa y descartando así la neutralidad asociada al término “comida”. Por otra parte, vuelve a aparecer en este gráfico la referencia a las personas mayores a través de las palabras “viejo” y “doña”, al tiempo que “edad” es el segundo término con mayor nivel de correlación con “gobierno”. Ante estas observaciones podría aventurarse la hipótesis de que las personas de edad avanzada son un grupo particularmente afectado por la acción del gobierno desde las perspectivas de los conjuntos de murga. La alta correlación entre “cambios” y “gobierno” es también muy elocuente, en tanto coincide con el viraje ideológico que se produjo en nuestro país a partir de la última elección nacional.

```{r echo=FALSE, message=FALSE, warning=FALSE, include=TRUE}

asoc_lacalle <- textstat_simil(dfm_textos, selection = "lacalle",
                method = "correlation",margin = "features")%>%
                as.data.frame()%>%
                dplyr::arrange(-correlation)%>%
                dplyr::top_n(12)

asoc_lacalle$correlation <- round(asoc_lacalle$correlation,2)

plot_asoc_lacalle <- ggplot(asoc_lacalle, aes(x = reorder(feature1, correlation), 
                            y = correlation,
                            fill = feature1)) +
                            geom_bar(stat = "identity", position = "dodge") +
                            geom_text(aes(label = correlation), vjust = -0.5, size = 3) +
                            coord_cartesian(ylim = c(0.50, 1)) +
                            xlab("") +
                            ylab("Nivel de Correlación") +
                            scale_fill_manual(values = c(rep("#D7B5D8", 12))) +
                            ggtitle("Palabras correlacionadas con la palabra 'Lacalle'") +
                            theme(legend.position="none")
plot_asoc_lacalle
```

De este último gráfico destaca principalmente la altísima correlación estadística (0.99%) de los siete primeros términos. Casi todas las veces que se nombra al presidente Luis Lacalle Pou se lo hace en referencia a los “chats” divulgados recientemente, a un pedido de ayuda (“ayudame”), o a términos propios del mundo financiero y la actividad empresarial (“inversor”, “inviertes”, "dólares”). La palabra “clase” también presenta un nivel de correlación alto con “Lacalle”, dando a entender que la figura del presidente se analiza generalmente en términos de clase, sea o no de forma crítica. 

La segunda línea de análisis propuesta consiste en la construcción de redes de co-ocurrencia entre los términos más frecuentes. En este caso, se procedió al análisis de todos los textos en su conjunto, como también a la distribución de los mismos según nuestras dos variables de interés. 

```{r echo=FALSE, message=FALSE, warning=FALSE, include=TRUE}
base_textos = dfm_textos %>%
fcm(context = "document")

feat <- names(topfeatures(base_textos, 30))
base_textos_select <- fcm_select(base_textos, pattern = feat, selection = "keep")
size <- log(colSums(dfm_select(base_textos, feat, selection = "keep")))

plot_co_ocurrencia_general <- textplot_network(base_textos_select, 
                                     min_freq = 0.8, 
                                     vertex_size = size / max(size) * 3,
                                     edge_color="#ff9d5c") +
                                     ggtitle("Red de co-ocurrencia entre los términos más frecuentes",
                                     subtitle = "En los textos de todas las murgas")
plot_co_ocurrencia_general
```

El primero de los gráficos de co-ocurrencia se construyó considerando los textos de todos los conjuntos de murga. En él se observa una red bastante densa de co-ocurrencia de términos. “Uruguay” y “gobierno”, así como “Uruguay” y “democracia”, presentan fuertes vinculaciones entre sí, constituyendo los principales núcleos temáticos. Las palabras “repetir”, “repetitivo” y “rutina” configuran un segundo núcleo temático, vinculándose fuertemente con los términos “escuela”, “reforma” y "plata", en lo que probablemente sea una referencia directa al debate sobre la repetición escolar a raíz de las modificaciones impuestas por la última reforma educativa.   

A continuación se presentan los resultados del análisis de co-ocurrencia de los términos más frecuentes en los textos según pertenezcan murgas de mayor o menor trayectoria.

```{r echo=FALSE, message=FALSE, warning=FALSE, include=TRUE}
base_murgas_tradicionales = dfm_murgas_tradicionales %>%
fcm(context = "document")

feat <- names(topfeatures(base_murgas_tradicionales, 30))
base_murgas_tradicionales_select <- fcm_select(base_murgas_tradicionales, pattern = feat, selection = "keep")
size <- log(colSums(dfm_select(base_murgas_tradicionales, feat, selection = "keep")))

plot_co_ocurrencia_murgas_tradicionales <- textplot_network(base_murgas_tradicionales_select, 
                                               min_freq = 0.8, 
                                               vertex_size = size / max(size) * 3,
                                               edge_color="#ff9d5c") +
                                               ggtitle("Red de co-ocurrencia entre los términos más frecuentes",
                                               subtitle = "En los textos de las murgas de mayor trayectoria")

plot_co_ocurrencia_murgas_tradicionales
```

En la red de co-ocurrencia correspondiente a las murgas de mayor trayectoria vuelve a repetirse la tendencia de la red anterior. No se visualizan grandes diferencias en rasgos generales, en tanto se mantienen los núcleos discursivos (democracia-Uruguay, repetición-escuela-rutina), como también las vinculaciones entre los distintos elementos que las componen. Las diferencias más significativas resultan de que la palabra “reforma” no figura dentro de los términos que co-ocurren con “escuela”, y que a las vinculaciones entre "democracia" y "Uruguay" se le suman los términos "dolor", "gritando" y "vacío" de fuerte connotación negativa.

```{r echo=FALSE, message=FALSE, warning=FALSE, include=TRUE}

base_murgas_nuevas = dfm_murgas_nuevas %>%
fcm(context = "document")

feat <- names(topfeatures(base_murgas_nuevas, 30))
base_murgas_nuevas_select <- fcm_select(base_murgas_nuevas, pattern = feat, selection = "keep")
size <- log(colSums(dfm_select(base_murgas_nuevas, feat, selection = "keep")))

plot_co_ocurrencia_murgas_nuevas <- textplot_network(base_murgas_nuevas_select, 
                                                            min_freq = 0.8, 
                                                            vertex_size = size / max(size) * 3,
                                                            edge_color="#ff9d5c") +
                                                            ggtitle("Red de co-ocurrencia entre los términos más frecuentes",
                                                            subtitle = "En los textos de las murgas de menor trayectoria")

plot_co_ocurrencia_murgas_nuevas

```
La red de co-ocurrencia de las murgas más jóvenes presenta diferencias significativas frente a la anterior. En ella se visualiza un nuevo núcleo temático que vincula a los términos “democracia”, “influencers”, “incógnito” y “Luis”, modificando las vinculaciones que la palabra “democracia” tenía en la red anterior. Un segundo núcleo temático se funda sobre las vinculaciones entre “gobierno”, “blanco”, “negro”, lo cual podría dar cuenta de una referencia racial en el discurso acerca del gobierno. También se observa una alta co-ocurrencia de los términos “Lacalle” y “chat”, confirmando la tendencia observada en los gráficos de frecuencia analizados anteriormente. 

Por último, se analizarán los resultados del análisis de co-ocurrencia en función de la conformación de los equipos de letristas en términos de género. 

```{r echo=FALSE, message=FALSE, warning=FALSE, include=TRUE}
base_letristas_varones = dfm_letristas_varones %>%
fcm(context = "document")

feat <- names(topfeatures(base_letristas_varones, 30))
base_letristas_varones_select <- fcm_select(base_letristas_varones, pattern = feat, selection = "keep")
size <- log(colSums(dfm_select(base_letristas_varones, feat, selection = "keep")))

plot_co_ocurrencia_letristas_varones <- textplot_network(base_letristas_varones_select, 
                                                     min_freq = 0.8, 
                                                     vertex_size = size / max(size) * 3,
                                                     edge_color="#ff9d5c")+
                                                     ggtitle("Red de co-ocurrencia entre los términos más frecuentes",
                                                     subtitle = "En textos escritos exclusivamente por varones")

plot_co_ocurrencia_letristas_varones
```

En la primera de las redes puede observarse nuevamente la gravitación del discurso sobre los términos “democracia” y “Uruguay”, dos palabras estrechamente vinculadas que parecen conformar una tendencia discursiva que permea los textos de todas las murgas, independientemente de su tradición o del género de sus letristas. Este hecho pone de manifiesto la identidad esencialmente política de las murgas como un elemento que trasciende las particularidades de cada conjunto y que denota al fenómeno murguero como tal. 

```{r echo=FALSE, message=FALSE, warning=FALSE, include=TRUE}
base_letristas_mujeres = dfm_letristas_mujeres %>%
fcm(context = "document")

feat <- names(topfeatures(base_letristas_mujeres, 30))
base_letristas_mujeres_select <- fcm_select(base_letristas_mujeres, pattern = feat, selection = "keep")
size <- log(colSums(dfm_select(base_letristas_mujeres, feat, selection = "keep")))

plot_co_ocurrencia_letristas_mujeres <- textplot_network(base_letristas_mujeres_select, 
                                                         min_freq = 0.8, 
                                                         vertex_size = size / max(size) * 3,
                                                         edge_color="#ff9d5c") +
                                                         ggtitle("Red de co-ocurrencia entre los términos más frecuentes",
                                                         subtitle = "En textos escritos por al menos una mujer")

plot_co_ocurrencia_letristas_mujeres
```

La segunda red de co-ocurrencia definida en función del género de los letristas introduce algunos cambios con respecto a la anterior. En este caso, los términos “democracia” y “Uruguay” no figuran como un núcleo temático. En su lugar, aparece nuevamente la vinculación entre “rutina” y “repetir”,  asociados en este caso a los términos “Argentina”, “producto”, “niños”, “plata” y “comer”, entre otros. La co-ocurrencia de estos términos no resulta tan fácil de interpretar sin conocer su contexto de aparición. Cabe destacar que en esta red se visualiza por primera vez la palabra “narcos”, de lo cual se deduce que este grupo de conjuntos fue el que abordó este fenómeno en mayor medida, vinculándolo a términos tales como “simple”, "community" y “trabajo”.  

## Uso de diccionarios para la identificación de núcleos temáticos, tonos emocionales y figuras políticas relevantes

A fin de profundizar en el análisis de los tópicos que atravesaron el Concurso Oficial de Carnaval de este año, se procedió al uso de tres diccionario: uno construido especialmente para el caso, donde se definen cuatro núcleos temáticos (educación, economía, género y seguridad) con sus respectivos términos asociados; otro construido a partir del paquete “puy” (Nicolás Schmidt), donde se recopilan los nombres de todos los políticos uruguayos; y el diccionario LWIC en castellano para la identificación de emociones positivas y negativas en el discurso. 

El primer diccionario creado para el caso se construyó en función de tres temáticas que emergieron con frecuencia en análisis anteriores: economía, seguridad y educación. A estos se le sumó una cuarta temática: género. Si bien no contó con referencias explícitas en análisis anteriores, creemos pertinente analizarla en mayor profundidad, contemplando las distintas formas bajo las que puede emerger y evaluándolas en cada uno de los textos. A continuación se presentan estos cuatro tópicos con sus respectivos términos asociados:

Economía: "aumento*","tarifa/s", "OSE", "UTE", "Antel", "hambre", "alimento/s", "comida", "compra/r", "caro/s", "barato/s*", "precio/s", "pobre/s", "pobreza", "recorte/s", “ajuste/s", “presupuesto", "caja", "plata", "guita", "mango*", "dólar*", "inversión*", "gasto", "sueldo", "salario", “rico/s”, “millonario/s”, “economía”, “financiero/a”

Seguridad: "narcos", "cárcel", "prisión", "robo/s", "delincuente/s", "arma/s", "muerte/s", "violencia", "femicidio*", "homicidio*", "militar/es", "chorro/s", "droga/s", "miedo", "temor", "inseguridad", “boca”, “policía/s”, “patrullero”, “comisaría”, “seguridad”.

Educación: “escuela*", "liceo*", "colegio", "alumno*", "udelar", "maestro/s", "maestra/s", "docente/s", "educativa", "enseñar",  "aprender", “guri/gurises” “niños/as”, “estudiante”, “estudiar“, “materia/s”, “asignatura/s”, “libro/s”.

Género: “varón/es", "hombre/s", "mujer/es", "genero", "femicidio/s", "viola/n", “violación/es,  "muertas", "abusada/s", "abusador/es", “abuso/s”, “acoso”, “acosada/s”, "violento/s", "insegura/s", "sorora/s", "puta/s", "prostitución", "prostituta/s", "abolir/abolición", "regulacionismo", "abolicionismo", "trata", "cliente/s”, “patriarcado”, “machismo”, “machista/s”.

Cabe aclarar que los términos asociados a cada grupo de palabras no agotan la cantidad de palabras que pueden referir a las temáticas, ni tampoco son unívocas en su significado, existiendo cierto margen de error en su evaluación. Teniendo esto en cuenta, veamos las tablas que resumen los resultados de este primer análisis con el uso de diccionarios.

```{r echo=FALSE, message=FALSE, warning=FALSE, include=TRUE}
dict <- dictionary(list(
  economia = c("aumento*","tarifa*", "OSE", "UTE", "Antel", "hambre", "alimento*", 
               "comida", "compr*", "caro*", "barato*", "precio*", "pobre*", "pobreza",
               "recorte*", "presupuesto", "caja", "plata", "guita", "mango*", "dólar*",
               "inversión*", "gasto", "sueldo", "salario", "ajuste*", "rico*", 
               "millonario*", "economia", "financier*"),
  seguridad = c("narcos","cárcel", "prisión", "robo*", "delincuente*", "arma*", 
                "muerte*", "violencia", "femicidio*", "homicidio*", "militar*",
                "chorro*", "droga*","miedo", "temor", "inseguridad", "boca*", 
                "policia*", "seguridad","patrullero", "comisaria"),
  educacion = c("escuela*", "liceo*", "colegio", "alumno*", "udelar",
                "maestro*", "maestra*", "docente*", "educativa", "enseñar",
                "aprender", "guri*", "niñ*", "estudiante*", "estudi*", 
                "materia*", "asignatura*", "libro*"),
  genero = c("varon*", "hombre*", "mujer*","genero", "femicidio*", "viola*", 
             "muertas", "abusada*", "abusador*", "violento*", "insegura*", "sorora*",
             "puta*", "prostitucion", "prostituta*", "aboli*", "regulacionismo", 
             "abolicionismo", "trata", "cliente*", "abuso*", "acoso", "acosad*", 
             "patriarcado", "machista*", "machismo")))
  

dict_result <- dfm_lookup(dfm_textos, dict, nomatch = "no_aparece")
dict_result <- convert(dict_result, to = "data.frame") 
dict_result$doc_id <- df_textos$doc_id 
dict_result$antiguedad <- df_textos$antiguedad 
dict_result$genero_letristas <- df_textos$genero_letristas

kable(dict_result)

```
La tabla aquí presentada sintetiza la cantidad de menciones a cada uno de los núcleos temáticos por conjunto. Como puede observarse, la categoría “economía” cuenta con múltiples menciones en la mayoría de los conjuntos, oscilando entre las dos y las trece apariciones de alguno de sus términos. La categoría “seguridad” presenta una tendencia distinta: si bien los valores oscilan en un rango similar, la cantidad de menciones entre los distintos conjuntos no es tan equitativa como en el caso anterior, siendo que mayoría hacen pocas menciones a la temática. La categoría “educación” se comporta de una manera similar: cuenta con pocas o nulas menciones a excepción de dos o tres conjuntos donde la cifra se dispara. Por último, la categoría “género” cuenta con muy pocas menciones a nivel general: solo tres conjuntos se refieren a alguno de sus términos al menos una vez. El conjunto “Mi Vieja Mula” se destaca como el único que presenta seis menciones a la temática de género en su espectáculo. 

Al analizar la distribución de los núcleos temáticos según la antigüedad de los conjuntos, se visualizan los siguientes resultados.

```{r echo=FALSE, message=FALSE, warning=FALSE, include=TRUE}

tabla_dict_result_antiguedad <- dict_result %>%
            group_by(antiguedad) %>%
                     summarise(economia = sum(economia), 
                     economia_prop = sum(economia)/sum(economia, seguridad, educacion, genero, no_aparece)*100,
                     seguridad = sum(seguridad), 
                     seguridad_prop = sum(seguridad)/sum(economia, seguridad, educacion, genero, no_aparece)*100,
                     educacion = sum(educacion),
                     educacion_prop = sum(educacion)/sum(economia, seguridad, educacion, genero, no_aparece)*100,
                     genero = sum(genero),
                     genero_prop = sum(genero)/sum(economia, seguridad, educacion, genero, no_aparece)*100)

kable(tabla_dict_result_antiguedad)

tabla_dict_result_antiguedad <- tabla_dict_result_antiguedad[c(1,2,4,6,8)]
melted_table_dict_antiguedad <- melt(tabla_dict_result_antiguedad, id.vars="antiguedad")
plot_table_dict_antiguedad <- ggplot(melted_table_dict_antiguedad, 
                                     aes(x=variable, y=value, fill=variable)) + 
                                     geom_col() +
                                     theme_classic() +
                                     facet_grid(~antiguedad) +
                                     labs(x="Núcleos temáticos",
                                          y="Cantidad de referencias") +
                                     theme(legend.position="none")
plot_table_dict_antiguedad
```

En el gráfico puede visualizarse con mayor claridad la cantidad de menciones en términos absolutos de cada eje temático, mientras que la tabla permite ver su proporción dentro del total de menciones. En ambos podemos observar que la mención a cuestiones del orden económico se distribuye de manera equitativa, repitiéndose la tendencia global antes vista. En cuanto al eje “seguridad”, se observa una diferencia significativa tanto en términos absolutos como relativos: las murgas tradicionales son más propensas a abordar esta temática en comparación a las más jóvenes. Lo mismo sucede, aunque con menor significatividad estadística, con las referencias a la educación, que predominan mayormente en los textos de las murgas tradicionales. La referencia al género, si bien es escasa en ambos grupos, cobra mayor fuerza en las murgas de menor trayectoria. Esto podría llevarnos a trazar la hipótesis de que los conjuntos surgidos en el ámbito de Murga Joven, compuestos generalmente por personas más jóvenes que la media, son más proclives a abordar cuestiones relativas al género, que en ocasiones resultan incómodas para generaciones anteriores y se alejan de las consignas clásicas de la murga. 

Al analizar la distribución de las referencias en función del género de los letristas, se observan los siguientes resultados.

```{r echo=FALSE, message=FALSE, warning=FALSE, include=TRUE}

tabla_dict_result_genero <- dict_result  %>%
            group_by(genero_letristas)%>%
                      summarise(economia = sum(economia), 
                      economia_prop = sum(economia)/sum(economia, seguridad, educacion, genero, no_aparece)*100,
                      seguridad = sum(seguridad), 
                      seguridad_prop = sum(seguridad)/sum(economia, seguridad, educacion, genero, no_aparece)*100,
                      educacion = sum(educacion),
                      educacion_prop = sum(educacion)/sum(economia, seguridad, educacion, genero, no_aparece)*100,
                      genero = sum(genero),
                      genero_prop = sum(genero)/sum(economia, seguridad, educacion, genero, no_aparece)*100)

kable(tabla_dict_result_genero)

tabla_dict_result_genero <- tabla_dict_result_genero[c(1,2,4,6,8)]
melted_table_dict_genero <- melt(tabla_dict_result_genero, id.vars="genero_letristas")
plot_table_dict_genero<- ggplot(melted_table_dict_genero, 
                                     aes(x=variable, y=value, fill=variable)) + 
                                     geom_col() +
                                     theme_classic() +
                                     facet_grid(~genero_letristas) +
                                     labs(x="Núcleos temáticos",
                                         y="Cantidad de referencias") +
                                     theme(legend.position="none")
plot_table_dict_genero
```

En este caso, las menciones a la economía son levemente mayores en murgas que no cuentan con mujeres letristas, mientras que los conjuntos que cuentan con al menos una mujer letrista retoman las temáticas de seguridad y educación con mayor frecuencia relativa. Hasta aquí se observan tendencias similares a las anteriores, no pudiéndose atribuir la incidencia del género de los y las letristas en la frecuencia con que se abordan estas temáticas. Cuando se observa la temática de género, sin embargo, llama la atención que aquellas murgas cuyos textos no fueron escritos por mujeres son quienes más abordan la temática. 

El segundo diccionario utilizado a fines analíticos fue construido a partir del paquete puy() diseñado por el politólogo Nicolás Schmidt. El mismo contiene un conjunto de datos sobre políticos uruguayos: sus nombres, los cargos que han ocupado y su filiación partidaria, entre otros. En tanto el objetivo era analizar los políticos más mencionados por los conjuntos a nivel general, se procedió a extraer el atributo “político” de la base de datos, almacenando en un vector de caracteres únicamente sus nombres y apellidos. Luego se realizó una limpieza de los datos, eliminando los nombres de pila y los signos de puntuación. Finalmente, los caracteres de este vector fueron migrados a un diccionario del paquete quenteda, que posteriormente fue evaluado en cada uno de los documentos. De este análisis resultaron las tablas que podemos observar a continuación.

```{r echo=FALSE, message=FALSE, warning=FALSE, include=FALSE}

politicos_uy <- buscar_puy()$politico

politicos_uy <- paste0(sapply(strsplit(politicos_uy, ","), "[[", 1), ",")

politicos_uy <- tolower(politicos_uy)

politicos_uy <- gsub("[[:punct:]]", "", politicos_uy)

dict_politicos <- dictionary(list(politicos = politicos_uy))

dfm_textos <- dfm(tokens(df_textos$texto,
                         remove_punct = TRUE, 
                         remove_numbers = TRUE), 
                         tolower=TRUE,
                         verbose = FALSE) %>%
                         dfm_remove(pattern = c(quanteda::stopwords("spanish"),
                         mis_stopwords)) %>%
                         dfm_trim(min_termfreq = 5)

dict_politicos_result <- dfm_lookup(dfm_textos, dict_politicos, nomatch="no_aparece")

dict_politicos_result <- convert(dict_politicos_result, to = "data.frame") 

dict_politicos_result$doc_id <- df_textos$doc_id 
dict_politicos_result$antiguedad <- df_textos$antiguedad 
dict_politicos_result$genero_letristas <- df_textos$genero_letristas

```

```{r echo=FALSE, message=FALSE, warning=FALSE, include=TRUE}

kable(dict_politicos_result)

tabla_dict_politicos_antiguedad <- dict_politicos_result %>%
                                   group_by(antiguedad) %>%
                                   summarise(politicos= sum(politicos))

kable(tabla_dict_politicos_antiguedad)

tabla_dict_politicos_genero <- dict_politicos_result %>%
                               group_by(genero_letristas) %>%
                               summarise(politicos= sum(politicos))

kable(tabla_dict_politicos_genero)

politicos_contexto <- kwic(tokens(df_textos$texto), dict_politicos, window=10)
```

Tal como se desprende de la primera tabla, la cantidad de referencias a figuras políticas oscilan entre las ocho y las cuarenta y seis según el conjunto. En general, se visualizan más menciones dentro de las murgas jóvenes y en aquellas que cuentan únicamente con letristas varones en oposición a los otros dos grupos. 

Si bien el dato de la cantidad de referencias a figuras políticas es valioso para el análisis, resulta interesante también observar cuáles fueron las figuras más mencionadas, así como su contexto de aparición en los textos. Para ello puede revisarse la tabla "politicos_contexto" en el entorno de R Studio, en tanto sus dimensiones no permitieron que sea colocada en este documento.

Cabe destacar que, si bien se realizó una limpieza de los signos de puntuación del diccionario, la tabla aún cuenta con términos que deben ser descartados en el análisis por conducir a errores. No obstante, una vez que se hallan las figuras políticas dentro de la tabla, es posible observar el contexto en que fueron nombradas y deducir de allí la connotación que se les atribuyó. Algunas de ellas son Luis Lacalle Pou, Graciela Bianchi, Arturo Heber, Julio María Sanguinetti, Óscar Andrade, Azucena Arbeleche, Carolina Cosse, Manini Ríos, Daniel Salinas, Laura Raffo y Yamandú Orsi, entre otras. Las múltiples referencias a estas figuras dan cierto indicio de la cuota de protagonismo público que adquirieron durante el último año, mientras que una revisión de los resultados del análisis de su contexto de aparición es capaz de dar cuenta del nivel de prestigio del que gozan desde la perspectiva de los conjuntos. 

El último diccionario utilizado en esta sección fue LWIC-Spanish, creado a los efectos de identificar emociones y elementos subjetivos en los documentos de texto y establecer puntajes en función de ellos. En este caso, el objetivo fue identificar la cantidad de connotaciones positivas y negativas en los textos de los distintos conjuntos a partir de las palabras que utilizan, para luego evaluar su distribución según las variables de interés. Una vez realizado este análisis, se procedió a la construcción de los dos gráficos que se observan a continuación.


```{r echo=FALSE, message=FALSE, warning=FALSE, include=TRUE}
lwic <- readRDS("C:/Users/Usuario/Desktop/R aplicado al análisis cualitativo/Entrega/EmoPosNeg_SPA.rds")
lwic_result <- dfm_lookup(dfm_textos, dictionary = lwic)
lwic_result <- convert(lwic_result, to = "data.frame") 
lwic_result$doc_id <- df_textos$doc_id 
lwic_result$antiguedad <- df_textos$antiguedad 
lwic_result$genero_letristas <- df_textos$genero_letristas

lwic_result$puntaje <- lwic_result$EmoPos-lwic_result$EmoNeg
lwic_result$sentimiento=ifelse(lwic_result$puntaje<0,"Negativo","Positivo")
lwic_result$sentimiento=ifelse(lwic_result$puntaje==0,"Neutral",lwic_result$sentimiento)

tabla_lwic_result_antiguedad <- lwic_result %>%
                                group_by(antiguedad) %>%
                                summarise(emociones_positivas = sum(EmoPos),
                                          emociones_negativas = sum(EmoNeg),
                                          puntaje = sum(puntaje)) 

melted_table_antiguedad <- melt(tabla_lwic_result_antiguedad, id.vars="antiguedad")

plot_lwic_antiguedad <- ggplot(melted_table_antiguedad, aes(x=variable, y=value, fill=variable)) + 
                                geom_col() +
                                labs(x="Emociones",
                                     y="Cantidad de referencias") +
                                scale_fill_discrete(labels=c("Emociones positivas", 
                                                             "Emociones negativas", 
                                                             "Diferencia entre ambas")) +
                                theme_classic() +
                                facet_grid(~antiguedad) +
                                theme(legend.position="none")
plot_lwic_antiguedad

tabla_lwic_result_genero <- lwic_result %>%
  group_by(genero_letristas) %>%
  summarise(emociones_positivas = sum(EmoPos),
            emociones_negativas = sum(EmoNeg),
            puntaje = sum(puntaje))

melted_table_genero <- melt(tabla_lwic_result_genero, id.vars="genero_letristas")

plot_lwic_genero <- ggplot(melted_table_genero, aes(x=variable, y=value, fill=variable)) + 
                            geom_col() +
                            labs(x="Emociones",
                                 y="Cantidad de referencias") +
                            scale_fill_discrete(labels=c("Emociones positivas", 
                                                         "Emociones negativas", 
                                                         "Diferencia entre ambas")) +
                            theme_classic() +
                            facet_grid(~genero_letristas) +
                            theme(legend.position="none")

plot_lwic_genero
```

A partir del primer gráfico puede observarse la predominancia del uso de palabras con connotación positiva frente a aquellas con connotación negativa, tanto en las murgas de menor como de mayor trayectoria (si bien en estas últimas la brecha entre ambas aumenta). Esta tendencia se repite en el segundo gráfico, donde los puntajes (construidos a partir de la diferencia absoluta entre la cantidad de referencias positivas y negativas) presentan leves diferencias respecto a las del primer gráfico. Esto parece darnos el indicio de que, si bien las murgas se caracterizan por su tono crítico y sus interpelaciones constantes al estado de las cosas, no todo en sus textos es crítica, o bien la crítica se asocia a términos positivos, entendiéndose como una actitud favorable y necesaria. También es probable que el uso de la ironía en los textos pueda estar afectando los resultados del análisis de sentimiento, haciendo pasar por positivo lo que es sátira o sarcasmo. Este es un elemento a tener en cuenta para futuros análisis. 

## Conclusiones

A nivel general, es posible concluir que la aplicación de los distintos métodos de análisis cualitativo (análisis de frecuencia de palabras, redes de co-ocurrencia y uso de diccionarios) han puesto de manifiesto la alusión permanente de todos los conjuntos de murga a cuestiones de índole sociopolítica, siendo el sistema político, la democracia, el trabajo y la educación los principales centros de gravitación de sus textos. Esto puede interpretarse a la luz de lo dicho por  Gandolfo (2007) acerca de la identidad históricamente popular de la murga y su crítica permanente hacia los que detentan el poder: “diferentes murgas se han identificado con una ideología política y con una clase social en particular y han hecho de su arte una herramienta ideológica. La murga, según algunos entrevistados, debe cantarle a las clases populares, porque es de allí de dónde proviene y de dónde surgen los murguistas, de los barrios "laburantes".” (Gandolfo, 2007: 35).

Otra reflexión importante que surge a raíz del análisis es la necesidad de contextualizar los textos, producidos a dos años de la instalación de un gobierno de orientación neoliberal que implicó un viraje ideológico respecto a la orientación progresista de los últimos tres gobiernos del país. Una línea de análisis interesante para futuros trabajos podría ser la comparación entre los textos producidos por las murgas durante los gobiernos progresistas y el actual, a fin de examinar las formas que adopta la crítica al poder bajo distintos contextos políticos. 

En cuanto al contraste de los textos según las dos variables de interés definidas al inicio, puede concluirse que la comparación por antigüedad de los conjuntos arrojó diferencias más significativas que la comparación por género de los y las letristas. Un resultado llamativo es la poca frecuencia con que se instaló la problemática de género, al menos a través del uso de los términos más esperables. Un análisis que utilizara la codificación manual a fin de categorizar los textos en mayor detalle podría arrojar más luz sobre esta cuestión; esta también se plantea como línea de análisis a desarrollarse en un futuro. 

Es importante recordar que los textos aquí analizados constituyen tan solo una muestra de la totalidad de textos que concursan este año en la categoría de murga, por lo que sus resultados están lejos de ser concluyentes o generalizables a un universo más amplio. Este trabajo pretendió ser tan solo una aproximación de carácter exploratorio al fenómeno de la murga desde los métodos de análisis provistos por los distintos paquetes de R que fueron utilizados a lo largo del trabajo.

## Bibliografía

Gandolfo, J. Murga e identidad. Transformaciones y permanencias. Tesis de grado. Montevideo: Udelar. FCS, 2007.

Pereira Silva, M. Metamorfosis de las Murgas. Tesis de grado. Montevideo : Udelar. FCS, 2013.

DAECPU. Murgas 2023. Recuperado de https://www.daecpu.org.uy/fichas-tecnicas-2023/murgas-2023.html 